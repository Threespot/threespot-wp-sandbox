{"version":3,"file":"./js/plugin_settings.js","mappings":"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","sources":["webpack://gravityformsrecaptcha/./js/src/plugin_settings.js"],"sourcesContent":["/* global jQuery, gform, grecaptcha, gforms_recaptcha_recaptcha_strings */\n\n( ( $ ) => {\n\t/**\n\t * Handles reCAPTCHA v2 plugin settings validation.\n\t *\n\t * @since 1.0\n\t *\n\t * @return {void}\n\t */\n\tconst recaptchaV2Settings = () => {\n\t\tconst v2Settings = {};\n\n\t\t/**\n\t\t * Initialize reCAPTCHA v2 settings.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.init = () => {\n\t\t\tv2Settings.cacheElements();\n\t\t\tv2Settings.addEventListeners();\n\t\t};\n\n\t\t/**\n\t\t * Cache the fields used by this handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.cacheElements = () => {\n\t\t\tv2Settings.container = $( 'div[id=\"gform_setting_reset_v2\"]' );\n\t\t\tv2Settings.fields = {\n\t\t\t\tsiteKey: $( 'input[name=\"_gform_setting_site_key_v2\"]' ),\n\t\t\t\tsecretKey: $( 'input[name=\"_gform_setting_secret_key_v2\"]' ),\n\t\t\t\treset: $( 'input[name=\"_gform_setting_reset_v2\"]' ),\n\t\t\t\ttype: $( 'input[name=\"_gform_setting_type_v2\"]' ),\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t\t * Add event listeners for this handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv2Settings.addEventListeners = () => {\n\t\t\tv2Settings.fields.siteKey.on( 'change', window.loadRecaptcha );\n\t\t\tv2Settings.fields.secretKey.on( 'change', window.loadRecaptcha );\n\t\t\tv2Settings.fields.type.on( 'change', () => window.loadRecaptcha() );\n\t\t};\n\n\t\t/**\n\t\t * Handles showing and hiding the reCAPTCHA itself.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\twindow.loadRecaptcha = () => {\n\t\t\tconst self = {};\n\n\t\t\t/**\n\t\t\t * Initialize the reCAPTCHA rendering process.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.init = () => {\n\t\t\t\tv2Settings.recaptcha = $( '#recaptcha' );\n\t\t\t\tv2Settings.save = $( '#gform-settings-save' );\n\t\t\t\tself.flushExistingState();\n\n\t\t\t\t// Reset key status.\n\t\t\t\t// Note: recaptcha is misspelled here for legacy reasons.\n\t\t\t\t$( '#recpatcha .gform-settings-field__feedback' ).remove();\n\n\t\t\t\t// If no public or private key is provided, exit.\n\t\t\t\tif ( ! self.canBeDisplayed() ) {\n\t\t\t\t\tself.hideRecaptcha();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tv2Settings.save.prop( 'disabled', true );\n\n\t\t\t\tself.showSelectedRecaptcha();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Renders the v2 reCAPTCHA.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @param {string} typeValue The selected type to render.\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.render = ( typeValue ) => {\n\t\t\t\t// Render reCAPTCHA.\n\t\t\t\tgrecaptcha.render(\n\t\t\t\t\t'recaptcha',\n\t\t\t\t\t{\n\t\t\t\t\t\tsitekey: v2Settings.fields.siteKey.val().trim(),\n\t\t\t\t\t\tsize: typeValue === 'invisible' ? typeValue : '',\n\t\t\t\t\t\tbadge: 'inline',\n\t\t\t\t\t\t'error-callback': () => {},\n\t\t\t\t\t\tcallback: () => v2Settings.save.prop( 'disabled', false ),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Flush the existing state of the reCAPTCHA handler.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.flushExistingState = () => {\n\t\t\t\twindow.___grecaptcha_cfg.clients = {};\n\t\t\t\twindow.___grecaptcha_cfg.count = 0;\n\t\t\t\tv2Settings.recaptcha.html( '' );\n\t\t\t\tv2Settings.fields.reset.val( '1' );\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Determines whether the reCAPTCHA can be shown.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {boolean} Whether the reCAPTCHA can be shown.\n\t\t\t */\n\t\t\tself.canBeDisplayed = () => {\n\t\t\t\treturn v2Settings.fields.siteKey.val() && v2Settings.fields.secretKey.val();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Hides the reCAPTCHA element.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.hideRecaptcha = () => {\n\t\t\t\tv2Settings.save.prop( 'disabled', false );\n\t\t\t\tv2Settings.container.hide();\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * Show the selected reCAPTCHA type.\n\t\t\t *\n\t\t\t * @since 1.0\n\t\t\t *\n\t\t\t * @return {void}\n\t\t\t */\n\t\t\tself.showSelectedRecaptcha = () => {\n\t\t\t\tconst typeValue = $( 'input[name=\"_gform_setting_type_v2\"]:checked' ).val();\n\n\t\t\t\tself.render( typeValue );\n\n\t\t\t\tswitch ( typeValue ) {\n\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\t$( '#gforms_checkbox_recaptcha_message, label[for=\"reset\"]' ).show();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'invisible':\n\t\t\t\t\t\t$( '#gforms_checkbox_recaptcha_message, label[for=\"reset\"]' ).hide();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error( 'Unexpected type selected.' );\n\t\t\t\t}\n\n\t\t\t\tv2Settings.container.show();\n\n\t\t\t\tif ( typeValue === 'invisible' ) {\n\t\t\t\t\tgrecaptcha.execute();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tself.init();\n\t\t};\n\n\t\tv2Settings.init();\n\t};\n\n\t/**\n\t * Handles reCAPTCHA v3 plugin settings validation.\n\t *\n\t * @since 1.0\n\t *\n\t * @return {void}\n\t */\n\tconst recaptchaV3Settings = () => {\n\t\tconst v3Settings = {};\n\n\t\t/**\n\t\t * Initializes the reCAPTCHA v3 settings handler.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.init = () => {\n\t\t\tv3Settings.token = '';\n\t\t\tv3Settings.strings = gforms_recaptcha_recaptcha_strings;\n\n\t\t\tv3Settings.cacheElements();\n\t\t\tv3Settings.validateKeysV3();\n\t\t\tv3Settings.addEventListeners();\n\t\t};\n\n\t\t/**\n\t\t * Cache HTML elements for the v3 reCAPTCHA settings.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.cacheElements = () => {\n\t\t\tv3Settings.fields = {\n\t\t\t\tsiteKey: '#site_key_v3',\n\t\t\t\tsecretKey: '#secret_key_v3',\n\t\t\t\tthreshold: '#score_threshold_v3',\n\t\t\t\tdisableBadge: '#disable_badge_v3',\n\t\t\t\tkeysStatus: '#gform_setting_recaptcha_keys_status_v3',\n\t\t\t};\n\n\t\t\tv3Settings.cache = {\n\t\t\t\tsiteKey: $( v3Settings.fields.siteKey ),\n\t\t\t\tsecretKey: $( v3Settings.fields.secretKey ),\n\t\t\t\tkeysStatus: $( v3Settings.fields.keysStatus ),\n\t\t\t\tsave: $( '#gform-settings-save' ),\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t\t * Setup event listeners for field validation.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.addEventListeners = () => {\n\t\t\tif ( ! v3Settings.strings.site_key.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$( v3Settings.fields.siteKey ).on( 'keyup', () => v3Settings.clearValidationFeedback() );\n\t\t\t$( v3Settings.fields.secretKey ).on( 'keyup', () => v3Settings.clearValidationFeedback() );\n\t\t};\n\n\t\t/**\n\t\t * Empty out the validation feedback if the fields are modified, as we can't yet know the status.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.clearValidationFeedback = () => {\n\t\t\tv3Settings.unsetValid( v3Settings.cache.siteKey.closest( '.gform-settings-input__container' ) );\n\t\t\tv3Settings.unsetValid( v3Settings.cache.secretKey.closest( '.gform-settings-input__container' ) );\n\t\t};\n\n\t\t/**\n\t\t * Handles validation of the v3 site key.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {Promise<unknown>} Returns a promise so this can be verified synchronously if checking the secret key.\n\t\t */\n\t\tv3Settings.getRecaptchaToken = () => {\n\t\t\treturn new Promise( ( resolve, reject ) => {\n\t\t\t\tconst siteKeyContainer = v3Settings.cache.siteKey.closest( '.gform-settings-input__container' );\n\n\t\t\t\ttry {\n\t\t\t\t\tconst { siteKey } = v3Settings.cache;\n\t\t\t\t\tconst siteKeyValue = siteKey.val().trim();\n\n\t\t\t\t\tif ( 0 === siteKeyValue.length ) {\n\t\t\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\t\t\tv3Settings.unsetValid( v3Settings.cache.keysStatus.closest( '.gform-settings-input__container' ) );\n\t\t\t\t\t\t$( v3Settings.fields.keysStatus ).find( 'input' ).val( '0' );\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tgrecaptcha.ready( () => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tgrecaptcha.execute( siteKeyValue, { action: 'submit' } ).then( ( token ) => {\n\t\t\t\t\t\t\t\tresolve( token );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\t\treject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\treject( error );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\n\t\t/**\n\t\t * Handles validation of the v3 site and secret keys.\n\t\t *\n\t\t * On page load, attempt to generate a reCAPTCHA token and immediately validate it on the server. If it's good,\n\t\t * we'll update the presentation of the keys to indicate success or failure.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.validateKeysV3 = () => {\n\t\t\tconst siteKeyContainer = v3Settings.cache.siteKey.closest( '.gform-settings-input__container' );\n\t\t\tconst secretKeyContainer = v3Settings.cache.secretKey.closest( '.gform-settings-input__container' );\n\t\t\tconst keysStatusInput = $( v3Settings.fields.keysStatus ).find( 'input' );\n\n\t\t\tif ( ! $( v3Settings.fields.siteKey ).val().trim().length ) {\n\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\tv3Settings.unsetValid( secretKeyContainer );\n\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tv3Settings.getRecaptchaToken()\n\t\t\t\t.then( ( token ) => {\n\t\t\t\t\tv3Settings.token = token;\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tv3Settings.setInvalid( siteKeyContainer );\n\t\t\t\t\tv3Settings.setInvalid( secretKeyContainer );\n\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t} )\n\t\t\t\t.finally( () => {\n\t\t\t\t\t$.ajax(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\tdataType: 'JSON',\n\t\t\t\t\t\t\turl: v3Settings.strings.ajaxurl,\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\taction: 'verify_secret_key',\n\t\t\t\t\t\t\t\tnonce: v3Settings.strings.nonce,\n\t\t\t\t\t\t\t\ttoken: v3Settings.token,\n\t\t\t\t\t\t\t\tsite_key_v3: $( v3Settings.fields.siteKey ).val(),\n\t\t\t\t\t\t\t\tsecret_key_v3: $( v3Settings.fields.secretKey ).val(),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t).then( ( response ) => {\n\t\t\t\t\t\tswitch ( response.data.keys_status ) {\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\t\tv3Settings.setValid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.setValid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '1' );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\t\tv3Settings.setInvalid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.setInvalid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tv3Settings.unsetValid( siteKeyContainer );\n\t\t\t\t\t\t\t\tv3Settings.unsetValid( secretKeyContainer );\n\t\t\t\t\t\t\t\tkeysStatusInput.val( '0' );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display no feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.unsetValid = ( el ) => {\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display the successful feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.setValid = ( el ) => {\n\t\t\tel.addClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\t/**\n\t\t * Updates the text field to display the error feedback.\n\t\t *\n\t\t * @since 1.0\n\t\t *\n\t\t * @param {Object} el The jQuery element.\n\t\t *\n\t\t * @return {void}\n\t\t */\n\t\tv3Settings.setInvalid = ( el ) => {\n\t\t\tel.removeClass( 'gform-settings-input__container--feedback-success' );\n\t\t\tel.addClass( 'gform-settings-input__container--feedback-error' );\n\t\t};\n\n\t\tv3Settings.init();\n\t};\n\n\t$( document ).ready( () => {\n\t\trecaptchaV3Settings();\n\t\trecaptchaV2Settings();\n\t\tgform.adminUtils.handleUnsavedChanges( '#gform-settings' );\n\t} );\n} )( jQuery );\n"],"names":["$","recaptchaV2Settings","v2Settings","init","cacheElements","addEventListeners","container","fields","siteKey","secretKey","reset","type","on","window","loadRecaptcha","self","recaptcha","save","flushExistingState","remove","canBeDisplayed","hideRecaptcha","prop","showSelectedRecaptcha","render","typeValue","grecaptcha","sitekey","val","trim","size","badge","errorCallback","callback","___grecaptcha_cfg","clients","count","html","hide","show","Error","execute","recaptchaV3Settings","v3Settings","token","strings","gforms_recaptcha_recaptcha_strings","validateKeysV3","threshold","disableBadge","keysStatus","cache","site_key","length","clearValidationFeedback","unsetValid","closest","getRecaptchaToken","Promise","resolve","reject","siteKeyContainer","siteKeyValue","find","ready","action","then","error","secretKeyContainer","keysStatusInput","catch","setInvalid","finally","ajax","method","dataType","url","ajaxurl","data","nonce","site_key_v3","secret_key_v3","response","keys_status","setValid","el","removeClass","addClass","document","gform","adminUtils","handleUnsavedChanges","jQuery"],"sourceRoot":""}